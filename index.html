<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RunComp Ultimate</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
}
header {
  background: #111;
  color: white;
  padding: 20px;
  text-align: center;
}
.container {
  padding: 20px;
}
input, button {
  padding: 10px;
  margin: 5px 0;
  width: 100%;
  box-sizing: border-box;
}
button {
  background: #ff5f5f;
  border: none;
  color: white;
  font-weight: bold;
  cursor: pointer;
}
button.secondary {
  background: #555;
}
.card {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 10px;
}
.card img {
  width: 100%;
  border-radius: 10px;
}
.admin {
  display: none;
}
.actions button {
  margin-top: 5px;
}
.winner {
  color: green;
  font-weight: bold;
}
</style>
</head>

<body>

<header>
  <h1>ðŸ’· RunComp Ultimate</h1>
  <p>Competitions with live draws</p>
</header>

<div class="container">

<h3>Your Name</h3>
<input id="username" placeholder="Enter your name">
<button onclick="saveName()">Confirm Name</button>

<hr>

<h2>Live Competitions</h2>
<div id="competitionList"></div>

<button onclick="adminLogin()">Admin Login</button>

<div class="admin" id="adminPanel">
<hr>
<h2>Admin Panel</h2>

<input id="compName" placeholder="Competition name">
<input id="compPrice" placeholder="Ticket price (Â£)">
<input id="compImage" placeholder="Image URL">
<input id="compDate" type="datetime-local">

<button onclick="addCompetition()">Add Competition</button>
</div>

<hr>

<h2>Winners</h2>
<div id="winnerList"></div>

</div>

<script>
let competitions = JSON.parse(localStorage.getItem("competitions")) || [];
let winners = JSON.parse(localStorage.getItem("winners")) || [];

function saveName() {
  const name = document.getElementById("username").value;
  localStorage.setItem("username", name);
  alert("Name saved");
}

function adminLogin() {
  const pass = prompt("Enter admin password:");
  if (pass === "admin123") {
    document.getElementById("adminPanel").style.display = "block";
  } else {
    alert("Wrong password");
  }
}

function addCompetition() {
  competitions.push({
    name: compName.value,
    price: compPrice.value,
    image: compImage.value,
    date: compDate.value
  });
  save();
}

function editCompetition(i) {
  const c = competitions[i];
  const name = prompt("Edit name", c.name);
  const price = prompt("Edit price", c.price);
  const image = prompt("Edit image URL", c.image);
  const date = prompt("Edit draw date", c.date);

  competitions[i] = { name, price, image, date };
  save();
}

function deleteCompetition(i) {
  if (confirm("Delete this competition?")) {
    competitions.splice(i, 1);
    save();
  }
}

function pickWinner(i) {
  const user = localStorage.getItem("username") || "Anonymous";
  winners.push(`${competitions[i].name} - Winner: ${user}`);
  save();
}

function save() {
  localStorage.setItem("competitions", JSON.stringify(competitions));
  localStorage.setItem("winners", JSON.stringify(winners));
  render();
}

function render() {
  competitionList.innerHTML = "";
  competitions.forEach((c, i) => {
    competitionList.innerHTML += `
      <div class="card">
        <img src="${c.image}">
        <h3>${c.name}</h3>
        <p>Ticket: Â£${c.price}</p>
        <p>Draw: ${c.date}</p>
        <div class="actions">
          <button onclick="pickWinner(${i})">Pick Winner</button>
          <button class="secondary" onclick="editCompetition(${i})">Edit</button>
          <button class="secondary" onclick="deleteCompetition(${i})">Delete</button>
        </div>
      </div>
    `;
  });

  winnerList.innerHTML = winners.map(w => `<p class="winner">${w}</p>`).join("");
}

render();
</script>

</body>
</html>